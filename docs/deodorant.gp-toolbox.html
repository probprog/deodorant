<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>deodorant.gp-toolbox documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Deodorant</span> <span class="project-version">0.1.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>deodorant</span></div></div></li><li class="depth-2 branch"><a href="deodorant.acq-functions.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>acq-functions</span></div></a></li><li class="depth-2 branch"><a href="deodorant.broadcast-functions.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>broadcast-functions</span></div></a></li><li class="depth-2 branch"><a href="deodorant.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="deodorant.covar-functions.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>covar-functions</span></div></a></li><li class="depth-2 branch"><a href="deodorant.default-params.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>default-params</span></div></a></li><li class="depth-2 branch current"><a href="deodorant.gp-toolbox.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>gp-toolbox</span></div></a></li><li class="depth-2 branch"><a href="deodorant.helper-functions.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>helper-functions</span></div></a></li><li class="depth-2 branch"><a href="deodorant.hmc.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>hmc</span></div></a></li><li class="depth-2 branch"><a href="deodorant.hyper-priors.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>hyper-priors</span></div></a></li><li class="depth-2"><a href="deodorant.scaling-functions.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>scaling-functions</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="deodorant.gp-toolbox.html#var--.3Etrained-gp-obj"><div class="inner"><span>-&gt;trained-gp-obj</span></div></a></li><li class="depth-1"><a href="deodorant.gp-toolbox.html#var-convert-output-to-std-dev"><div class="inner"><span>convert-output-to-std-dev</span></div></a></li><li class="depth-1"><a href="deodorant.gp-toolbox.html#var-create-trained-gp-obj"><div class="inner"><span>create-trained-gp-obj</span></div></a></li><li class="depth-1"><a href="deodorant.gp-toolbox.html#var-gp-grad-log-likelihood"><div class="inner"><span>gp-grad-log-likelihood</span></div></a></li><li class="depth-1"><a href="deodorant.gp-toolbox.html#var-gp-log-likelihood"><div class="inner"><span>gp-log-likelihood</span></div></a></li><li class="depth-1"><a href="deodorant.gp-toolbox.html#var-gp-mixture-mu-sig"><div class="inner"><span>gp-mixture-mu-sig</span></div></a></li><li class="depth-1"><a href="deodorant.gp-toolbox.html#var-gp-predict-mu-cov"><div class="inner"><span>gp-predict-mu-cov</span></div></a></li><li class="depth-1"><a href="deodorant.gp-toolbox.html#var-gp-predict-mu-sig"><div class="inner"><span>gp-predict-mu-sig</span></div></a></li><li class="depth-1"><a href="deodorant.gp-toolbox.html#var-gp-predict-with-derivatives"><div class="inner"><span>gp-predict-with-derivatives</span></div></a></li><li class="depth-1"><a href="deodorant.gp-toolbox.html#var-gp-sample"><div class="inner"><span>gp-sample</span></div></a></li><li class="depth-1"><a href="deodorant.gp-toolbox.html#var-gp-train"><div class="inner"><span>gp-train</span></div></a></li><li class="depth-1"><a href="deodorant.gp-toolbox.html#var-map-.3Etrained-gp-obj"><div class="inner"><span>map-&gt;trained-gp-obj</span></div></a></li><li class="depth-1"><a href="deodorant.gp-toolbox.html#var-subtract-mean-fn"><div class="inner"><span>subtract-mean-fn</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">deodorant.gp-toolbox</h1><div class="doc"><pre class="plaintext">GP functions for training, testing, calculating the marginal likelihood
and its derivatives.</pre></div><div class="public anchor" id="var--.3Etrained-gp-obj"><h3>-&gt;trained-gp-obj</h3><div class="usage"><code>(-&gt;trained-gp-obj prior-mean-fn x-obs L psi inv-K inv-L sigma-n log-likelihood x*-diff-fn k*-fn k-new-fn marginal-prior-var grad-prior-mean-fn-x grad-k*-fn)</code></div><div class="doc"><pre class="plaintext">Positional factory function for class deodorant.gp_toolbox.trained-gp-obj.
</pre></div></div><div class="public anchor" id="var-convert-output-to-std-dev"><h3>convert-output-to-std-dev</h3><div class="usage"><code>(convert-output-to-std-dev mu var &amp; args)</code></div><div class="doc"><pre class="plaintext">Takes the output of a gp prediction function and converts the variance
terms to standard deviation terms for both original derivative</pre></div></div><div class="public anchor" id="var-create-trained-gp-obj"><h3>create-trained-gp-obj</h3><div class="usage"><code>(create-trained-gp-obj prior-mean-fn cov-fn x-obs y-obs alpha &amp; [grad-prior-mean-fn-x grad-prior-cov-fn-x])</code></div><div class="doc"><pre class="plaintext">Created a trained-gp-obj record that is used for efficient
prediction of gp at future points.

Accepts:     prior-mean-func
             cov-fn                  Same form as sent to gp train
             points                  Vector of pairs of [x y] observations
             alpha                   Vector of hyperparameters in same form as sent to gp train

Optional Inputs:
             grad-prior-mean-fn-x    Gradient of prior mean function.  Needed for some derivative
                                     calculations but not for basic use.
             grad-prior-cov-fn-x     Gradient of prior covariance function.  Needed for some derivative
                                     calculations but not for basic use.

Returns:     trained-gp-obj

Note that current usage of BOPP does not set these optional inputs.  They would be needed for anything
that requires taking gradients with respect to the GP inputs, for example solving the acquisition
function using gradient methods and left in for potential future convenience / other toolbox use.</pre></div></div><div class="public anchor" id="var-gp-grad-log-likelihood"><h3>gp-grad-log-likelihood</h3><div class="usage"><code>(gp-grad-log-likelihood grad-cov-fn x-diff-sq alpha L psi)</code></div><div class="doc"><pre class="plaintext">Calculates the gradient of the gp-log-likelihood with
respect to the hyperparameters.

Accepts:  grad-cov-fn  - Function to return grad of covariance func wrt
                         the hyperparameters returned as DxNxN matrix
          x-diff-sq    - see gp-train
          L            - see gp-train
          psi          - see gp-train</pre></div></div><div class="public anchor" id="var-gp-log-likelihood"><h3>gp-log-likelihood</h3><div class="usage"><code>(gp-log-likelihood L psi y-bar)</code></div><div class="doc"><pre class="plaintext">Calculates the gp-log-likelihood given L, psi and y-bar
</pre></div></div><div class="public anchor" id="var-gp-mixture-mu-sig"><h3>gp-mixture-mu-sig</h3><div class="usage"><code>(gp-mixture-mu-sig gp-predictors gp-weights xs)</code></div><div class="doc"><pre class="plaintext">Calculates the mean and standard deviation from a weighted
sum of gps, i.e. a gp mixture model.  Note that the resulting
distribution is not a Gaussian, (the marginals are mixtures of
Gaussians) but the mean and covariance is still analytic.

Accepts:
 gp-predictors - A collection of gp prediction functions
 gp-weights - The relative weights of the gps
 xs - Positions to calculate the estimates at

Returns:
 mus - The means of the points
 sigs - The standard deviations of the points</pre></div></div><div class="public anchor" id="var-gp-predict-mu-cov"><h3>gp-predict-mu-cov</h3><div class="usage"><code>(gp-predict-mu-cov gp x*)</code></div><div class="doc"><pre class="plaintext">Makes gp predictions for mu and
covariance for multiple points simultaneously.

Accepts   gp        - of type trained-gp-obj
          x*        - new points to evaluate   (MxD matrix)
          &amp; args    - if (first args) is true then the full covariance matrix
                      is returned instead of just the marginal variance

Returns   mu        - predicted means (M length vector)
          cov       - (MxM matrix) corresponding to the covariance between the prediction points</pre></div></div><div class="public anchor" id="var-gp-predict-mu-sig"><h3>gp-predict-mu-sig</h3><div class="usage"><code>(gp-predict-mu-sig gp x*)</code></div><div class="doc"><pre class="plaintext">Makes gp predictions for mu and marginal standard deviation
for multiple points simultaneously.

Accepts   gp        - of type trained-gp-obj
          x*        - new points to evaluate   (MxD matrix)

Returns   mu        - predicted means (M length vector)
          sig       - marginal predicted standard deviations</pre></div></div><div class="public anchor" id="var-gp-predict-with-derivatives"><h3>gp-predict-with-derivatives</h3><div class="usage"><code>(gp-predict-with-derivatives gp x*)</code></div><div class="doc"><pre class="plaintext">Makes gp predictions for mu, var, grad-mu and grad-var
given a gp-object and a single query point

Accepts    gp        - of type trained-gp-obj
           x*        - new points to evaluate   (D length vector)

Returns    mu        - predicted means                        (vector of length 1)
           var       - marginal predicted vartion             (vector of length 1)
           grad-mu   - derivative of the mean with respect to the dimensions of predicted points. (D length vector)
           grad-var  - derivative of the variance with respect to the dimensions of predicted points. (D length vector)</pre></div></div><div class="public anchor" id="var-gp-sample"><h3>gp-sample</h3><div class="usage"><code>(gp-sample gp x* n-samples)</code></div><div class="doc"><pre class="plaintext">Generates samples from a trained-gp-obj

Accepts   gp          - of type trained-gp-obj
          x*          - points to evaluate   (MxD matrix)
          n-samples   - number of samples to generate

Returns   f*          - sampled values for gp output (n-samples x M matrix).  Note that the y ~ N(f*,sigma-n^2)
          dist-f*     - mvn distribution object that allows for further efficient sampling if required</pre></div></div><div class="public anchor" id="var-gp-train"><h3>gp-train</h3><div class="usage"><code>(gp-train cov-fn x-diff-sq y-bar alpha)</code></div><div class="doc"><pre class="plaintext">Trains a gp, returns L and psi - the lower triangular matrix
and vector of differences required for prediction.

Accepts: cov-fn - a function taking inputs of x-diff-sq and
                  a vector of hyperparameters (not including noise
                  parameter and therefore corresponding to (rest alpha))
         x-diff-sq - a NxDxN matrix of squared distances of points
         y-bar  - observations minus the value of the prior mean function
                  at those points
         alpha  - a vector of hyperparameters ordered as
                 [log-sig-n log-sig-f-k1 log-rho-k1-dim-1 log-rho-k1-dim-2 ... log-sig-f-k2 ...]

Returns:  L     - lower triangular matrix used for gp prediction
          psi   - inv-K times y-bar</pre></div></div><div class="public anchor" id="var-map-.3Etrained-gp-obj"><h3>map-&gt;trained-gp-obj</h3><div class="usage"><code>(map-&gt;trained-gp-obj m__6522__auto__)</code></div><div class="doc"><pre class="plaintext">Factory function for class deodorant.gp_toolbox.trained-gp-obj, taking a map of keywords to field values.
</pre></div></div><div class="public anchor" id="var-subtract-mean-fn"><h3>subtract-mean-fn</h3><div class="usage"><code>(subtract-mean-fn mean-fn x y)</code></div><div class="doc"><pre class="plaintext">Subtracts the GP mean. Accepts a mean-fn from arguments [x] to a
scalar y, along with a collection of points [x y]. Returns a vector
of values (- y (mean-fn x)).</pre></div></div></div></body></html>